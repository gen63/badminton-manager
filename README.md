# 🏸 バドミントン練習管理システム

週3回のバドミントン練習で、約25人の参加者を1〜3面のコートに効率的に配置・管理するWebアプリケーションです。

## 🚀 デモ

**https://gen63.github.io/badminton-manager/**

## ✨ 主な機能

### Phase 0（現在のバージョン）

#### セッション管理
- ✅ **セッション作成** - コート数（1〜3）、点数（11/15/21）を設定
- ✅ **参加者管理** - 複数行一括入力対応（改行区切り）
- ✅ **LocalStorage保存** - ブラウザ内でデータ永続化

#### コート配置
- ✅ **自動配置機能**
  - 空のコートのみに配置（既存配置を保護）
  - プレイ回数、ペア履歴、対戦履歴を考慮した最適配置
  - 配置不可時はボタンを無効化（エラーメッセージなし）
- ✅ **メンバー交換機能**
  - コート内 ↔ コート内
  - コート内 ↔ 待機中
  - 休憩中のメンバーも交換可能
  - 選択中プレイヤーに「✕ 解除」ボタン表示
  - もう一度タップで選択解除

#### ゲーム進行
- ✅ **試合管理**
  - 試合開始・終了
  - リアルタイムタイマー表示
  - 試合終了後は自動的にプレイヤーが待機に戻る
- ✅ **スコア入力**
  - 専用画面で0〜30点を選択
  - 入力画面でメンバー交換可能
  - 遷移元に応じて戻り先を自動判定（メイン/履歴）
- ✅ **スコア未入力の試合** - メイン画面に最新5件を表示

#### 履歴・統計
- ✅ **試合履歴**
  - 全試合を2行表示（名前 vs 名前 / 時刻 経過時間 スコア）
  - ダブルタップでスコア編集
  - 編集モード切替で削除ボタン表示
  - 削除時は確認ダイアログ表示
- ✅ **履歴コピー**
  - 簡潔なフォーマット（日付 + 連番 + 名前 + スコア）
  - 統計情報なし、時刻なし、勝者なし

#### UI/UX
- ✅ **エラー通知のみ** - 成功トーストは表示しない（シンプル化）
- ✅ **コンパクトなデザイン** - 初期画面、入力エリアを縮小
- ✅ **選択状態の明確化** - チェックマーク、リング、拡大表示
- ✅ **レスポンシブ** - 3コート時も横スクロールなしで表示

### 配置アルゴリズムの特徴

優先順位に基づいて自動配置：

1. **プレイ回数の均等化** - プレイ回数が少ない人を優先
2. **待ち時間の最小化** - 最後にプレイしてから時間が経っている人を優先
3. **ペアの多様性** - 同じペアの組み合わせを避ける
4. **対戦相手の多様性** - 同じ対戦相手を避ける

## 🛠️ 技術スタック

- **フロントエンド**
  - React 19 + TypeScript
  - Vite（ビルドツール）
  - Tailwind CSS 4（スタイリング）
  - Zustand（状態管理）
  - React Router v7（ルーティング）

- **データ保存**
  - LocalStorage（Phase 0）
  - Firebase Firestore（Phase 1予定）

- **デプロイ**
  - GitHub Pages

## 📦 開発環境のセットアップ

### 必要なもの

- Node.js 18以上
- npm

### インストール

```bash
# リポジトリをクローン
git clone https://github.com/gen63/badminton-manager.git
cd badminton-manager

# 依存パッケージをインストール
npm install

# 開発サーバーを起動
npm run dev
```

開発サーバーが起動したら、ブラウザで `http://localhost:5173/badminton-manager/` にアクセス。

### ビルド

```bash
# 本番用ビルド
npm run build

# ビルドしたファイルをプレビュー
npm run preview
```

### デプロイ

```bash
# GitHub Pagesにデプロイ
npm run deploy
```

## 📱 使い方

### 1. セッション作成

- コート数（1〜3）を選択
- 目標点数（11/15/21）を選択
- 練習参加メンバーを入力（1行に1人）
- 最低4人以上必要

### 2. メイン画面

#### 一括配置
- ヘッダーの「一括配置」ボタンで空のコート全てに一度に配置
- 配置不可時はボタンが無効化される

#### メンバー交換
1. プレイヤー名をタップして選択（青/オレンジ色に変化）
2. 交換したい相手をタップ
3. 選択解除：もう一度タップ or 「✕ 解除」ボタン
4. 休憩中のメンバーも交換可能

#### ゲーム進行
- **開始** - 「開始」ボタンで試合開始（タイマー表示）
- **終了** - 「終了」ボタンで試合終了（メンバーは自動的に待機に戻る）

#### スコア入力
- メイン画面の「スコア未入力の試合」から「入力」ボタンをタップ
- 0〜30点をタップして順番に入力
- メンバー交換も可能
- 確定すると元の画面に戻る

#### 休憩設定
- 待機中のメンバーにあるコーヒーアイコンをタップ
- 休憩中は配置対象外になる

### 3. 履歴画面

- 全試合を2行形式で表示
- **ダブルタップ** - スコアを編集
- **編集ボタン** - 編集モードに切替
  - 編集モード時に削除ボタン（🗑️）が表示
  - 削除時は確認ダイアログ表示
- **コピーボタン** - 履歴をクリップボードにコピー
  - フォーマット：日付 + 連番 + 名前 + スコア

### 4. 設定画面

- コート数・点数の変更
- セッションのリセット（確認ダイアログ付き）

## 🗂️ プロジェクト構造

```
badminton-manager/
├── src/
│   ├── components/
│   │   ├── CourtCard.tsx           # コートカード（タイマー付き）
│   │   ├── EmptyState.tsx          # 空状態表示
│   │   └── Toast.tsx               # トースト通知（エラーのみ）
│   ├── hooks/
│   │   ├── useToast.ts             # トースト通知フック
│   │   └── useGameTimer.ts         # ゲームタイマーフック
│   ├── lib/
│   │   ├── algorithm.ts            # 配置アルゴリズム
│   │   └── utils.ts                # ユーティリティ関数
│   ├── pages/
│   │   ├── SessionCreate.tsx       # セッション作成
│   │   ├── MainPage.tsx            # メイン画面
│   │   ├── ScoreInputPage.tsx      # スコア入力
│   │   ├── HistoryPage.tsx         # 履歴・編集
│   │   └── SettingsPage.tsx        # 設定
│   ├── stores/
│   │   ├── sessionStore.ts         # セッション状態管理
│   │   ├── playerStore.ts          # プレイヤー状態管理
│   │   └── gameStore.ts            # ゲーム進行管理
│   └── types/
│       ├── player.ts               # Player型定義
│       ├── court.ts                # Court型定義
│       ├── match.ts                # Match型定義
│       └── session.ts              # Session型定義
├── doc/                            # 仕様書
└── public/
    ├── favicon.svg                 # カスタムアイコン
    └── manifest.json               # PWA設定
```

## 📋 Phase 0 実装機能（完了）

### コア機能
- ✅ セッション作成・管理
- ✅ 参加者管理（複数行入力）
- ✅ 自動配置（空のコートのみ）
- ✅ メンバー交換（待機中・休憩中含む）
- ✅ ゲーム進行管理
- ✅ スコア入力（専用画面）
- ✅ 試合履歴・編集・削除
- ✅ 履歴コピー（簡潔フォーマット）

### UI/UX改善
- ✅ エラー以外のトースト削除
- ✅ コンパクトなデザイン
- ✅ 選択状態の明確化
- ✅ 編集モード切替
- ✅ 動的遷移先判定
- ✅ ボタン無効化（エラー回避）
- ✅ LocalStorage保存
- ✅ GitHub Pagesデプロイ

## 🔜 Phase 1 予定

- 🔲 Firebase Firestore連携
- 🔲 リアルタイム同期
- 🔲 セッション共有（URL）
- 🔲 PWA対応（完全版）
- 🔲 プッシュ通知

## 🤝 貢献

バグ報告や機能提案は、GitHubのIssuesでお願いします。

## 📄 ライセンス

MIT License

## 👤 作成者

Gen (@genzwift)

---

**開発状況**: Phase 0 完了 🎉  
**最終更新**: 2026-01-30
